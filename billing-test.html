<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í† ìŠ¤ í˜ì´ë¨¼ì¸  - ë¹Œë§í‚¤ ë°œê¸‰ í…ŒìŠ¤íŠ¸</title>
    <script src="https://js.tosspayments.com/v2/standard"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            box-sizing: border-box;
        }
        input:focus {
            outline: none;
            border-color: #0064FF;
        }
        button {
            width: 100%;
            padding: 14px;
            background-color: #0064FF;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #0052CC;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .info-box {
            background-color: #f0f7ff;
            border-left: 4px solid #0064FF;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        .info-box p {
            margin: 5px 0;
            font-size: 13px;
            color: #333;
        }
        .warning-box {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        .warning-box p {
            margin: 5px 0;
            font-size: 13px;
            color: #856404;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”‘ ë¹Œë§í‚¤ ë°œê¸‰ í…ŒìŠ¤íŠ¸</h1>
        <p class="subtitle">í† ìŠ¤ í˜ì´ë¨¼ì¸  ìë™ê²°ì œ(ë¹Œë§) ì—°ë™ í…ŒìŠ¤íŠ¸</p>

        <div class="warning-box">
            <p><strong>âš ï¸ ì£¼ì˜ì‚¬í•­</strong></p>
            <p>1. í† ìŠ¤ ê°œë°œìì„¼í„°ì—ì„œ í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸ í‚¤ë¥¼ ë°œê¸‰ë°›ì•„ì•¼ í•©ë‹ˆë‹¤</p>
            <p>2. ë°±ì—”ë“œ ì„œë²„ê°€ <code>http://localhost:8080</code>ì—ì„œ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤</p>
            <p>3. í…ŒìŠ¤íŠ¸ ì¹´ë“œë²ˆí˜¸: <code>5570-0000-0000-0001</code></p>
        </div>

        <div class="info-box">
            <p><strong>ğŸ’¡ í…ŒìŠ¤íŠ¸ ì¹´ë“œ ì •ë³´</strong></p>
            <p>â€¢ ì¹´ë“œë²ˆí˜¸: 5570-0000-0000-0001</p>
            <p>â€¢ ìœ íš¨ê¸°ê°„: ì•„ë¬´ ë¯¸ë˜ ë‚ ì§œ</p>
            <p>â€¢ CVC: 123</p>
            <p>â€¢ ë¹„ë°€ë²ˆí˜¸: 00</p>
            <p>â€¢ ìƒë…„ì›”ì¼: 990101</p>
        </div>

        <div class="form-group">
            <label for="clientKey">í† ìŠ¤ í´ë¼ì´ì–¸íŠ¸ í‚¤ (Client Key)</label>
            <input
                type="text"
                id="clientKey"
                placeholder="test_ck_..."
                value=""
            >
        </div>

        <div class="form-group">
            <label for="customerKey">ê³ ê° ID (Customer Key)</label>
            <input
                type="text"
                id="customerKey"
                placeholder="ì˜ˆ: customer_test_001"
                value="customer_test_001"
            >
        </div>

        <button id="issueBillingBtn">ë¹Œë§í‚¤ ë°œê¸‰í•˜ê¸°</button>

        <div class="info-box" style="margin-top: 20px;">
            <p><strong>ğŸ“‹ í”Œë¡œìš°</strong></p>
            <p>1. ìœ„ ë²„íŠ¼ í´ë¦­ â†’ í† ìŠ¤ ê²°ì œì°½ íŒì—…</p>
            <p>2. í…ŒìŠ¤íŠ¸ ì¹´ë“œ ì •ë³´ ì…ë ¥</p>
            <p>3. ì„±ê³µ ì‹œ <code>/api/billing/success</code>ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸</p>
            <p>4. ë°±ì—”ë“œì—ì„œ ë¹Œë§í‚¤ ë°œê¸‰ API í˜¸ì¶œ</p>
            <p>5. ë¹Œë§í‚¤ DB ì €ì¥ ì™„ë£Œ</p>
        </div>
    </div>

    <script>
        let tossPayments = null;

        // í´ë¼ì´ì–¸íŠ¸ í‚¤ ì…ë ¥ ì‹œ TossPayments ì´ˆê¸°í™”
        document.getElementById('clientKey').addEventListener('input', (e) => {
            const clientKey = e.target.value.trim();
            if (clientKey.startsWith('test_ck_') || clientKey.startsWith('live_ck_')) {
                try {
                    tossPayments = TossPayments(clientKey);
                    console.log('TossPayments ì´ˆê¸°í™” ì™„ë£Œ');
                } catch (error) {
                    console.error('TossPayments ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
                    alert('í´ë¼ì´ì–¸íŠ¸ í‚¤ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                }
            }
        });

        // ë¹Œë§í‚¤ ë°œê¸‰ ë²„íŠ¼ í´ë¦­
        document.getElementById('issueBillingBtn').addEventListener('click', async () => {
            const clientKey = document.getElementById('clientKey').value.trim();
            const customerKey = document.getElementById('customerKey').value.trim();

            // ìœ íš¨ì„± ê²€ì‚¬
            if (!clientKey) {
                alert('í† ìŠ¤ í´ë¼ì´ì–¸íŠ¸ í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.\n\ní† ìŠ¤ ê°œë°œìì„¼í„°(https://developers.tosspayments.com)ì—ì„œ ë°œê¸‰ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            if (!customerKey) {
                alert('ê³ ê° IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (!tossPayments) {
                alert('TossPaymentsê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í´ë¼ì´ì–¸íŠ¸ í‚¤ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                // ë¹Œë§í‚¤ ë°œê¸‰ ìš”ì²­
                await tossPayments.requestBillingAuth({
                    method: "CARD",
                    customerKey: customerKey,
                    successUrl: window.location.origin + '/api/billing/success',
                    failUrl: window.location.origin + '/api/billing/fail',
                });
            } catch (error) {
                console.error('ë¹Œë§í‚¤ ë°œê¸‰ ì˜¤ë¥˜:', error);
                alert('ë¹Œë§í‚¤ ë°œê¸‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\n' + error.message);
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì•ˆë‚´
        window.addEventListener('load', () => {
            console.log('=== í† ìŠ¤ ë¹Œë§í‚¤ ë°œê¸‰ í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ===');
            console.log('1. í† ìŠ¤ ê°œë°œìì„¼í„°ì—ì„œ í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸ í‚¤ ë°œê¸‰');
            console.log('2. ìœ„ ì…ë ¥ë€ì— í´ë¼ì´ì–¸íŠ¸ í‚¤ ì…ë ¥');
            console.log('3. ë¹Œë§í‚¤ ë°œê¸‰í•˜ê¸° ë²„íŠ¼ í´ë¦­');
            console.log('4. í…ŒìŠ¤íŠ¸ ì¹´ë“œë¡œ ê²°ì œ ì •ë³´ ì…ë ¥');
            console.log('\ní…ŒìŠ¤íŠ¸ ì¹´ë“œ: 5570-0000-0000-0001');
        });
    </script>
</body>
</html>
